<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ma Ch√©rie üíñ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" sizes="32x32" href="icon-192.png">
  <link rel="shortcut icon" href="icon-192.png" type="image/png">

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ff7eb9">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="LoveMsg">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    body {
      margin: 0;
      min-height: 100vh;
      min-height: 100dvh;
      background: linear-gradient(
        270deg,
        #ffd6e8,
        #ffc0d9,
        #ffb3d1
      );
      background-size: 600% 600%;
      animation: gradientShift 20s ease infinite;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Segoe UI", sans-serif;
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
    }
    body.night {
      background: linear-gradient(
        270deg,
        #2b1a2f,
        #3a1f3f,
        #4a2450
      );
    }
    body.night .container {
      background: rgba(30, 20, 35, 0.55);
      border-color: rgba(255,255,255,0.15);
    }
    body.night .heart {
      opacity: 0.6;
      filter: drop-shadow(0 0 4px rgba(255,180,220,0.4));
    }
    body.valentines {
      background: radial-gradient(circle at top,
        #ff9acb,
        #ff4f9a,
        #b1005a
      );
    }
    body.valentines .container {
      background: rgba(255, 230, 240, 0.2);
      box-shadow:
        0 0 40px rgba(255, 80, 160, 0.8),
        0 30px 60px rgba(0,0,0,0.35);
    }
    body.valentines .heart {
      filter: drop-shadow(0 0 8px rgba(255,0,80,0.6));
      text-shadow:
        -2px -2px 0 #000,
         0px -2px 0 #000,
         2px -2px 0 #000,
        -2px  0px 0 #000,
         2px  0px 0 #000,
        -2px  2px 0 #000,
         0px  2px 0 #000,
         2px  2px 0 #000,
         0px  4px 8px rgba(0,0,0,0.35);
    }
    body.valentines .message {
      animation: heartbeat 2s infinite;
    }
    .hearts {
      position: absolute;
      inset: 0;
      z-index: 1;
      overflow: hidden;
    }
    .heart {
      cursor: pointer;
      transition: transform 0.2s ease, opacity 0.2s ease;
      position: absolute;
      bottom: -20px;
      animation: floatUp linear infinite;
      opacity: 0.85;
      filter: drop-shadow(0 0 6px rgba(255,126,185,0.6));
    }
    .heart.pop {
      transform: scale(1.8);
      opacity: 0;
    }
    .container {
      position: relative;
      z-index: 2;
      text-align: center;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      max-width: 90vw;
      padding: 1.5rem;
      gap: 1rem;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(2px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      padding: 2rem 2.5rem;
      border: 1px solid rgba(255,255,255,0.35);
    }
    .special-day .container {
      box-shadow:
        0 0 25px rgba(222, 45, 124, 0.6),
        0 20px 40px rgba(0,0,0,0.3);
    }
    .date, .message, .signature {
      text-shadow:
        -2px -2px 0 #000,
         0px -2px 0 #000,
         2px -2px 0 #000,
        -2px  0px 0 #000,
         2px  0px 0 #000,
        -2px  2px 0 #000,
         0px  2px 0 #000,
         2px  2px 0 #000,
         0px  4px 8px rgba(0,0,0,0.35);
      opacity: 0.95;
    }
    .date { 
      font-size: 1rem; 
    }
    .message { 
      font-size: clamp(1.6rem, 5vw, 2.6rem); 
      margin: auto 0; 
    }
    .container.sparkle {
      position: relative;
      overflow: hidden;
    }
    .container.sparkle::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(
        120deg,
        transparent 30%,
        rgba(255,255,255,0.6) 50%,
        transparent 70%
      );
      transform: translateX(-100%);
      animation: shimmer 2.5s ease-in-out 1;
      pointer-events: none;
    }
    .signature { 
      font-size: 1.1rem; 
    }
    .sparkle-word {
      position: relative;
      display: inline-block;
      color: #fff;
      animation: sparkleGlow 2.5s ease-in-out infinite;
    }
    @keyframes floatUp {
      from { transform: translateY(0); opacity: 0.85; }
      to { transform: translateY(-110vh); opacity: 0; }
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes shimmer {
      to { transform: translateX(100%); }
    }
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    @keyframes sparkleGlow {
      0%, 100% {
        text-shadow:
          0 0 4px rgba(255,255,255,0.4),
          0 0 8px rgba(255,200,230,0.4);
      }
      50% {
        text-shadow:
          0 0 6px rgba(255,255,255,0.8),
          0 0 14px rgba(255,200,230,0.9);
      }
    }
  </style>
</head>
<body>
  <div class="hearts" id="hearts"></div>
  <div class="container" id="container">
    <div class="date" id="date"></div>
    <div class="message" id="message"></div>
    <div class="signature">Yours, Marc</div>
  </div>
  <script>
    const messages = [
      "I love the way your eyes sparkle when you flash that gorgeous smile ü•∞‚ú®",
      "You're my favourite person ‚ù§Ô∏è",
      "You're absolutely stunning, inside and out üíï",
      "Always thinking of you üíï",
      "Your voice is one of Earth's loveliest sounds üíñ",
      "You make everything better üíñ",
      "I'm so lucky to have you ü•∞",
      "Your hair looks amazing every single day üíñ",
      "You are a shining gem üíé",
      "I can't imagine a better life than one with you üòò",
      "You fill me with joy üòä",
      "I feel like I've met my person with you üòò",
      "Your lips are my favourite place to see a smile üòò",
      "You are the most beautiful person on earth üòç",
      "I love cuddling you so much üòö",
      "You look incredible every time I see you üòç",
      "I will always look after you üíó",
      "You make me feel so warm, inside and out ü§ó",
      "I will forever be here for you üíñ",
      "My heart goes crazy when you get that playful glint in your eye ‚ú®",
      "You have the cutest smile I've ever seen üòä",
      "You mean the world to me ü•∞",
      "I could look into your gorgeous eyes for hours üòç",
      "Thank you so much for being your wonderful self üíù",
      "I am all yours for as long as you want me ‚ù§Ô∏è",
      "You deserve to be treated the best because you are the best ü•∞",
      "I adore everything about you üíò",
      "You make my days brighter just by being you üåü",
      "My feelings grow everytime I see your pretty face üòç",
      "Thinking about you always puts a smile on my face üòä",
      "You have such a beautiful heart üíñ",
      "Life feels lighter when you're around üí´",
      "You're truly one of a kind üíé",
      "I love feeling your smile when our lips meet üòò",
      "You are always a joy to be around üíï",
      "The kindness that shows in your eyes when you smile is so endearing üíñ",
      "I feel so grateful to know you ü•∞",
      "Everything feels better when I'm with you' üòä",
      "You're such a comfort to be around üíó",
      "You inspire me to be my best self üòä",
      "Your kindness means more than you know üíù",
      "Your hands are so warm and comforting ü§ó",
      "You have a way of making ordinary moments special ‚ú®",
      "I appreciate you more than words can say üíñ",
      "You're such a lovely presence in my life ü•∞",
      "Being around you feels like home üè°",
      "If I could, I would never stop kissing your beautiful lips üòò",
      "You always know how to make me smile üòä",
      "Your hands feel perfect in mine ü•∞",
      "You deserve all the good things üíï",
      "I treasure every moment we share üí´",
      "You're so easy to care about üíó",
      "I'm really thankful for you, ma belle fleur üå∑",
      "Your strength is incredibly inspiring üí™",
      "There is no woman in this universe sexier than you üî•",
      "Your empathetic nature is so lovely ü§ó",
      "Every time I see you, my heart does a happy dance üíÉ",
      "You're my favourite thought, every single day ü•∞",
      "Your cheeks are so kissable üòö",
      "I fall for you more every moment üòò",
      "Those dimples of yours are irresistible üòç",
      "Your hugs are my favourite place in the world ü§ó",
      "Your lips are dangerously kissable üòò",
      "Being with you feels like a dream I never want to wake up from üíï",
      "You make my heart skip beats every time üíì",
      "I adore every little thing about you, even the silly stuff üòö",
      "You're my sunshine on cloudy days ‚òÄ",
      "I want to hold your hand forever ü•∞",
      "Every love song suddenly makes sense because of you üé∂‚ù§",
      "You're the sweetest part of my life üç¨üíó",
      "The sparkle in your eyes lights up my whole day ‚ú®",
      "I love how just thinking of you makes me smile üòäüíò",
      "I'm addicted to you üíï",
      "No one makes me feel the way you do üíì",
      "Every day with you is my favourite day üíù",
      "You keep stealing my thoughts‚Ä¶ and my heart üíï",
      "You make it impossible not to smile üòöüíñ",
      "I swear you get cuter every single day üòè‚ù§",
      "You have no idea how much you make my heart race ü•∞",
      "The sound of your laughter is music to my ears üòç",
      "How are you this perfect and still mine? üòöüíï",
      "Just thinking about you makes my day so much better üòöüíò",
      "Your affection feels like the sweetest gift üíù",
      "Being near you makes everything feel right üíñ",
      "You are my happy place üåà",
      "I love the way you light up a room ‚ú®",
      "You're my favourite hello and hardest goodbye üíï",
      "You make even the simplest moments unforgettable üí´",
      "I feel so safe and adored with you ü•∞",
      "You're the reason I believe in magic ‚ú®",
      "Just seeing your name makes my heart skip a beat üíó",
      "I love dreaming about our future together üíñ",
      "You make my soul feel alive üåπ",
      "I'm so proud of everything you are üíï",
      "You turn ordinary days into special memories üí´",
      "You are my favourite part of every day üíñ",
      "I love how effortlessly you make me happy üíï",
      "I love how being with you is so easy and natural üíï",
      "You're my little piece of paradise üíó",
      "I can't imagine my world without you in it üíñ",
      "You're my favourite daydream üòç",
      "You make even silence feel comforting üíó",
      "I could spend forever just holding you close ü§ó",
      "You make life feel like a beautiful adventure üå∏",
      "You make every moment feel worthwhile üí´",
      "I love how well your sense of humour meshes with mine üíï",
      "I feel so lucky to share life with you üíñ",
      "I love how you inspire me every single day üíó"
    ];

    const specialMessages = {
      "01-01": "Happy New Year, my sweetheart! May your year be full of good times and great company üíñ",
      "12-25": "Merry Christmas, ma belle ch√©rie! Every day is a gift when I'm connected to you üíï",
      "12-29": "So excited to be going away with you! Prepare to be adored ‚ù§Ô∏è",
      "12-30": "Day 2 of our stay and I'm the happiest man on Earth because I'm with you üòä",
      "12-31": "I hope you've enjoyed our stay, I wish it could last forever ü•∞",
      "02-14": "Happy Valentine's Day sweetie! Today's message needs to be delivered in person ‚ù§Ô∏èüå∫"
    };

    const animatedWords = {
      sparkle: "sparkle-word"
    };

    const today = new Date();
    document.getElementById("date").textContent =
      today.toLocaleDateString(undefined, { weekday:"long", month:"long", day:"numeric" });

    const isValentines = today.getMonth() === 1 && today.getDate() === 14;

    if (isValentines) {
      document.body.classList.add("valentines");
    } else {
      const hour = today.getHours();
      if (hour >= 20 || hour < 6) {
        document.body.classList.add("night");
      }
    }

    function getDayOfYear(date) {
      const start = new Date(date.getFullYear(),0,0);
      const diff = date - start;
      return Math.floor(diff / (1000*60*60*24));
    }

    function seededRandom(seed) {
      const x = Math.sin(seed) * 10000;
      return x - Math.floor(x);
    }

    const month = String(today.getMonth() + 1).padStart(2, "0");
    const day = String(today.getDate()).padStart(2, "0");
    const todayKey = `${month}-${day}`;

    function applyWordAnimations(text) {
      let result = text;
      for (const word in animatedWords) {
        const className = animatedWords[word];
        const regex = new RegExp(`\\b(${word})\\b`, "gi");
        result = result.replace(
          regex,
          `<span class="${className}">$1</span>`
        );
      }
      return result;
    }

    let messageText;
    if (specialMessages[todayKey]) {
      messageText = specialMessages[todayKey];
      if (!isValentines) {
        document.body.classList.add("special-day");
      } else {
        document.querySelector(".signature").innerHTML =
          "Forever yours, Marc ‚ù§Ô∏è";
      }
    } else {
      const dayOfYear = getDayOfYear(today);
      const seed = today.getFullYear() * 1000 + dayOfYear;
      const messageIndex = Math.floor(seededRandom(seed) * messages.length);
      messageText = messages[messageIndex];
    }

    const messageEl = document.getElementById("message");
    const container = document.getElementById("container");
    const animatedHTML = applyWordAnimations(messageText);
    const tokens = animatedHTML.match(/(<[^>]+>|[^<]+)/g);

    let tokenIndex = 0;
    let charIndex = 0;
    const nodeStack = [messageEl];

    function typeWriter() {
      if (tokenIndex >= tokens.length) {
        container.classList.add("sparkle");
        return;
      }

      const token = tokens[tokenIndex];
      const currentNode = nodeStack[nodeStack.length - 1];

      if (/^<span\b/.test(token)) {
        const span = document.createElement("span");
        const classMatch = token.match(/class="([^"]+)"/);
        if (classMatch) span.className = classMatch[1];

        currentNode.appendChild(span);
        nodeStack.push(span);
        tokenIndex++;
        setTimeout(typeWriter, 0);
        return;
      }

      if (token === "</span>") {
        nodeStack.pop();
        tokenIndex++;
        setTimeout(typeWriter, 0);
        return;
      }

      if (charIndex < token.length) {
        currentNode.appendChild(
          document.createTextNode(token.charAt(charIndex))
        );
        charIndex++;
        setTimeout(typeWriter, 50);
      } else {
        charIndex = 0;
        tokenIndex++;
        setTimeout(typeWriter, 0);
      }
    }

    typeWriter();

    const heartsContainer = document.getElementById("hearts");
    const heartEmojis = isValentines
      ? ["üåπ","üíê","üå∏","‚ù§Ô∏è","üíñ","üíï","üíó","üíò","üíù"]
      : ["‚ù§Ô∏è","üíñ","üíï","üíó","üíò","üíù"];
    function createHeart() {
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.textContent = heartEmojis[Math.floor(Math.random()*heartEmojis.length)];
      heart.style.left = Math.random()*100+"vw";
      heart.style.fontSize = (14+Math.random()*26)+"px";
      heart.style.animationDuration = (5+Math.random()*6)+"s";

      heart.addEventListener("click", () => {
        heart.classList.add("pop");
        if (navigator.vibrate) navigator.vibrate(10);
        setTimeout(() => heart.remove(), 200);
      });

      heartsContainer.appendChild(heart);
      setTimeout(()=>heart.remove(),11000);
    }
    setInterval(createHeart, 350);

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
        .then(() => console.log('Service Worker registered'))
        .catch(err => console.error('SW registration failed:', err));
    }
  </script>
</body>
</html>